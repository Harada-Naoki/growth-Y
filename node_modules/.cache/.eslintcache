[{"C:\\Users\\nharada\\marketing-app\\src\\index.js":"1","C:\\Users\\nharada\\marketing-app\\src\\App.js":"2","C:\\Users\\nharada\\marketing-app\\src\\LoginForm.js":"3","C:\\Users\\nharada\\marketing-app\\src\\RegisterForm.js":"4","C:\\Users\\nharada\\marketing-app\\src\\utils\\apiRequest.js":"5","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_1.js":"6","C:\\Users\\nharada\\marketing-app\\src\\components\\Page1.js":"7","C:\\Users\\nharada\\marketing-app\\src\\components\\ChatBubble.js":"8","C:\\Users\\nharada\\marketing-app\\src\\components\\QuizQuestion.js":"9","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_2.js":"10","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_3.js":"11","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_4.js":"12","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_5.js":"13","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_6.js":"14","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_7.js":"15","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_8.js":"16","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_9.js":"17","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_10.js":"18","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_13.js":"19","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_12.js":"20","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_11.js":"21","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_14.js":"22","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_15.js":"23","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_16.js":"24","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_17.js":"25","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_18.js":"26","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_19.js":"27","C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_20.js":"28","C:\\Users\\nharada\\marketing-app\\src\\ProgressTracker.js":"29"},{"size":230,"mtime":1720141044095,"results":"30","hashOfConfig":"31"},{"size":3173,"mtime":1722497851132,"results":"32","hashOfConfig":"31"},{"size":1943,"mtime":1722239295027,"results":"33","hashOfConfig":"31"},{"size":1968,"mtime":1722239289002,"results":"34","hashOfConfig":"31"},{"size":1834,"mtime":1722414684541,"results":"35","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"36","hashOfConfig":"31"},{"size":8884,"mtime":1722493453161,"results":"37","hashOfConfig":"31"},{"size":495,"mtime":1722413091533,"results":"38","hashOfConfig":"31"},{"size":1563,"mtime":1722487954492,"results":"39","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"40","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"41","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"42","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"43","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"44","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"45","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"46","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"47","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"48","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"49","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"50","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"51","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"52","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"53","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"54","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"55","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"56","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"57","hashOfConfig":"31"},{"size":10605,"mtime":1722413165385,"results":"58","hashOfConfig":"31"},{"size":3888,"mtime":1722501182286,"results":"59","hashOfConfig":"31"},{"filePath":"60","messages":"61","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},"p12g13",{"filePath":"63","messages":"64","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"65","messages":"66","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"67","messages":"68","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"69","messages":"70","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"71","messages":"72","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"73","messages":"74","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"75"},{"filePath":"76","messages":"77","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"78","messages":"79","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"80","messages":"81","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"82","messages":"83","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"84","messages":"85","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"86","messages":"87","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"88","messages":"89","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"90","messages":"91","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"92","messages":"93","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"94","messages":"95","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"96","messages":"97","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"98","messages":"99","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"100","messages":"101","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"102","messages":"103","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"104","messages":"105","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"106","messages":"107","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"108","messages":"109","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"110","messages":"111","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"112","messages":"113","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"114","messages":"115","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"116","messages":"117","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"62"},{"filePath":"118","messages":"119","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"C:\\Users\\nharada\\marketing-app\\src\\index.js",[],["120","121"],"C:\\Users\\nharada\\marketing-app\\src\\App.js",[],"C:\\Users\\nharada\\marketing-app\\src\\LoginForm.js",[],"C:\\Users\\nharada\\marketing-app\\src\\RegisterForm.js",[],"C:\\Users\\nharada\\marketing-app\\src\\utils\\apiRequest.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_1.js",[],"C:\\Users\\nharada\\marketing-app\\src\\components\\Page1.js",["122"],"import React, { useState, useEffect, useRef } from 'react';\r\nimport { Link, useNavigate, useParams } from 'react-router-dom';\r\nimport apiRequest from '../utils/apiRequest';\r\nimport '../App.css';\r\nimport ChatBubble from '../components/ChatBubble';\r\nimport QuizQuestion from '../components/QuizQuestion';\r\nimport { BookOpen } from 'lucide-react';\r\n\r\n// フックの前にチャプターデータをロード\r\nconst chapterData = Array.from({ length: 20 }, (_, i) => require(`../data/chapter1_${i + 1}.js`));\r\n\r\nfunction Page1() {\r\n  const { chapterId } = useParams();\r\n  const chapterIndex = parseInt(chapterId, 10) - 1;\r\n  const navigate = useNavigate();\r\n\r\n  const [visibleStep, setVisibleStep] = useState(0);\r\n  const [quizStarted, setQuizStarted] = useState(false);\r\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\r\n  const [score, setScore] = useState(0);\r\n  const [showFeedback, setShowFeedback] = useState(false);\r\n  const [isCorrect, setIsCorrect] = useState(false);\r\n  const [showResults, setShowResults] = useState(false);\r\n  const chatContainerRef = useRef(null);\r\n  const [studyTime, setStudyTime] = useState(0);\r\n  const [startTime, setStartTime] = useState(Date.now());\r\n  const [allImagesLoaded, setAllImagesLoaded] = useState(false);\r\n\r\n  // チャプターデータの有効性チェック\r\n  const isValidChapter = chapterIndex >= 0 && chapterIndex < chapterData.length;\r\n  const chapter = isValidChapter ? chapterData[chapterIndex] : null;\r\n\r\n  const saveStudyTime = async (time) => {\r\n    try {\r\n      await apiRequest('/api/progress/update', {\r\n        method: 'POST',\r\n        data: {\r\n          chapterId: `1_${chapterId}`,\r\n          studyTime: time\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error('Error saving study time', error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!isValidChapter) {\r\n      // 無効なチャプターIDの場合、ホームページにリダイレクト\r\n      navigate('/');\r\n      return;\r\n    }\r\n\r\n    const handleVisibilityChange = () => {\r\n      if (document.visibilityState === 'hidden' || document.hidden) {\r\n        const endTime = Date.now();\r\n        const elapsed = Math.floor((endTime - startTime) / 1000);\r\n        setStudyTime(prevTime => {\r\n          const newTime = prevTime + elapsed;\r\n          saveStudyTime(newTime);\r\n          return newTime;\r\n        });\r\n      } else {\r\n        setStartTime(Date.now());\r\n      }\r\n    };\r\n\r\n    const handleWindowFocus = () => {\r\n      setStartTime(Date.now());\r\n    };\r\n\r\n    const handleWindowBlur = () => {\r\n      const endTime = Date.now();\r\n      const elapsed = Math.floor((endTime - startTime) / 1000);\r\n      setStudyTime(prevTime => {\r\n        const newTime = prevTime + elapsed;\r\n        saveStudyTime(newTime);\r\n        return newTime;\r\n      });\r\n    };\r\n\r\n    document.addEventListener('visibilitychange', handleVisibilityChange);\r\n    window.addEventListener('focus', handleWindowFocus);\r\n    window.addEventListener('blur', handleWindowBlur);\r\n\r\n    return () => {\r\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n      window.removeEventListener('focus', handleWindowFocus);\r\n      window.removeEventListener('blur', handleWindowBlur);\r\n      const endTime = Date.now();\r\n      const elapsed = Math.floor((endTime - startTime) / 1000);\r\n      saveStudyTime(studyTime + elapsed);\r\n    };\r\n  }, [isValidChapter, navigate, startTime, studyTime, chapterId]);\r\n\r\n  // コンテンツが追加されるたびに最下部にスクロール\r\n  useEffect(() => {\r\n    if (chatContainerRef.current) {\r\n      chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;\r\n    }\r\n  }, [visibleStep, quizStarted, currentQuestionIndex, showFeedback, showResults, allImagesLoaded]);\r\n\r\n  // 画像の読み込み完了を監視\r\n  useEffect(() => {\r\n    const images = chatContainerRef.current?.getElementsByTagName('img');\r\n    if (images) {\r\n      let loadedCount = 0;\r\n      const totalImages = images.length;\r\n\r\n      const handleImageLoad = () => {\r\n        loadedCount += 1;\r\n        if (loadedCount === totalImages) {\r\n          setAllImagesLoaded(true);\r\n        }\r\n      };\r\n\r\n      if (totalImages === 0) {\r\n        setAllImagesLoaded(true);\r\n      } else {\r\n        for (const img of images) {\r\n          if (img.complete) {\r\n            handleImageLoad();\r\n          } else {\r\n            img.addEventListener('load', handleImageLoad);\r\n            img.addEventListener('error', handleImageLoad);\r\n          }\r\n        }\r\n      }\r\n\r\n      return () => {\r\n        for (const img of images) {\r\n          img.removeEventListener('load', handleImageLoad);\r\n          img.removeEventListener('error', handleImageLoad);\r\n        }\r\n      };\r\n    }\r\n  }, [visibleStep, quizStarted, currentQuestionIndex]);\r\n\r\n  const completeChapter = async () => {\r\n    try {\r\n      const endTime = Date.now();\r\n      const elapsed = Math.floor((endTime - startTime) / 1000);\r\n      const totalStudyTime = studyTime + elapsed;\r\n      await saveStudyTime(totalStudyTime);\r\n\r\n      await apiRequest('/api/progress/update', {\r\n          method: 'POST',\r\n          data: {\r\n              chapterId: `1_${chapterId}`,\r\n              completed: true,\r\n              studyTime: totalStudyTime\r\n          }\r\n      });\r\n\r\n      navigate('/');\r\n    } catch (error) {\r\n      console.error('Error completing chapter', error);\r\n    }\r\n  };\r\n\r\n  const showNextStep = () => {\r\n    if (visibleStep < chapter.content.length - 1) {\r\n      setVisibleStep(visibleStep + 1);\r\n      setAllImagesLoaded(false); // 新しいステップが追加されるたびにリセット\r\n    } else {\r\n      setQuizStarted(true);\r\n    }\r\n  };\r\n\r\n  const handleQuizAnswer = (selectedAnswer) => {\r\n    const currentQuestion = chapter.quizQuestions[currentQuestionIndex];\r\n    const correct = selectedAnswer === currentQuestion.correctAnswer;\r\n    setIsCorrect(correct);\r\n    setShowFeedback(true);\r\n    if (correct) {\r\n      setScore(score + 1);\r\n    }\r\n  };\r\n\r\n  const nextQuestion = () => {\r\n    setShowFeedback(false);\r\n    if (currentQuestionIndex < chapter.quizQuestions.length - 1) {\r\n      setCurrentQuestionIndex(currentQuestionIndex + 1);\r\n    } else {\r\n      setShowResults(true); // クイズ終了後の結果表示状態に変更\r\n    }\r\n  };\r\n\r\n  if (!isValidChapter) {\r\n    return null; // または適切なローディング表示\r\n  }\r\n\r\n  const { title, chapterOverview, content, quizQuestions } = chapter;\r\n  const progressPercentage = ((visibleStep + 1) / content.length) * 100;\r\n\r\n  return (\r\n    <div className=\"Content\">\r\n      <div className=\"chapter-header\">\r\n        <div className=\"title-container\">\r\n          <BookOpen className=\"book-icon\" size={50} />\r\n          <h1 className=\"main-title\">{title}</h1>\r\n        </div>\r\n      \r\n        {visibleStep === 0 && (\r\n          <div className=\"overview-container\">\r\n            <h2 className=\"overview-title\">チャプター概要</h2>\r\n            <p className=\"overview-text\">{chapterOverview}</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      <div className=\"progress-bar-container\">\r\n        <div className=\"progress-bar\" style={{ width: `${progressPercentage}%` }}></div>\r\n      </div>\r\n      \r\n      <div className=\"chat-container\" ref={chatContainerRef}>\r\n        {content.slice(0, visibleStep + 1).map((item, index) => (\r\n          <div key={index}>\r\n            {item.type === \"sectionTitle\" ? (\r\n              <h3 className=\"section-title\">{item.text}</h3>\r\n            ) : (\r\n              <ChatBubble sender={item.sender} type={item.type} text={item.text} src={item.src} alt={item.alt} />\r\n            )}\r\n          </div>\r\n        ))}\r\n\r\n        {quizStarted && (\r\n          <QuizQuestion\r\n            question={quizQuestions[currentQuestionIndex]?.question}\r\n            options={quizQuestions[currentQuestionIndex]?.options}\r\n            handleAnswer={handleQuizAnswer}\r\n            showFeedback={showFeedback}\r\n            isCorrect={isCorrect}\r\n            explanation={quizQuestions[currentQuestionIndex]?.explanation}\r\n            nextQuestion={nextQuestion}\r\n            currentQuestionIndex={currentQuestionIndex}\r\n            totalQuestions={quizQuestions.length}\r\n            score={score}\r\n            completeChapter={completeChapter}\r\n            showResults={showResults}\r\n            setShowResults={setShowResults}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {!quizStarted && (\r\n        <button onClick={showNextStep} className=\"next-button\">\r\n          {visibleStep < content.length - 1 ? \"次へ\" : \"確認テストを始める\"}\r\n        </button>\r\n      )}\r\n      \r\n      <div className=\"links-container\">\r\n        <Link to={`/marketing-app/Page1/${parseInt(chapterId) + 1}`}>次の章へ</Link>\r\n        <Link to=\"/\">ホームに戻る</Link>  \r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Page1;\r\n","C:\\Users\\nharada\\marketing-app\\src\\components\\ChatBubble.js",[],"C:\\Users\\nharada\\marketing-app\\src\\components\\QuizQuestion.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_2.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_3.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_4.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_5.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_6.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_7.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_8.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_9.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_10.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_13.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_12.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_11.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_14.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_15.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_16.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_17.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_18.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_19.js",[],"C:\\Users\\nharada\\marketing-app\\src\\data\\chapter1_20.js",[],"C:\\Users\\nharada\\marketing-app\\src\\ProgressTracker.js",[],{"ruleId":"123","replacedBy":"124"},{"ruleId":"125","replacedBy":"126"},{"ruleId":"127","severity":1,"message":"128","line":94,"column":6,"nodeType":"129","endLine":94,"endColumn":65,"suggestions":"130"},"no-native-reassign",["131"],"no-negated-in-lhs",["132"],"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'saveStudyTime'. Either include it or remove the dependency array.","ArrayExpression",["133"],"no-global-assign","no-unsafe-negation",{"desc":"134","fix":"135"},"Update the dependencies array to be: [isValidChapter, navigate, startTime, studyTime, chapterId, saveStudyTime]",{"range":"136","text":"137"},[3275,3334],"[isValidChapter, navigate, startTime, studyTime, chapterId, saveStudyTime]"]